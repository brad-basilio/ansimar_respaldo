var j=Object.defineProperty;var b=(t,i,s)=>i in t?j(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s;var x=(t,i,s)=>(b(t,typeof i!="symbol"?i+"":i,s),s);import{j as e}from"./FileViewer-DkaHswXt.js";import{r as n}from"./TrackingPixels-B80Lgev0.js";import{c as u}from"./ReactAppend-CY8yKZvG.js";import{B as N}from"./Base-BIlLTJC_.js";import{C as g}from"./CreateReactScript-BEktg6JA.js";import{T as v}from"./Table-Dhu2mzRt.js";import{D as p}from"./DxButton-CsjWvhyj.js";import{R as r}from"./ReactAppend-Yu2UtNlL.js";import{B as w}from"./Results-D258VEiO.js";import{M as y}from"./Modal-CJBbhQ-7.js";import{S as C}from"./sweetalert2.all-C96erxsa.js";import"./index-CbrplguO.js";import"./tippy-react.esm-CIcmk6y-.js";/* empty css              */import"./Logout-CHcSRTk-.js";import"./main-D1ujSG59.js";import"./___vite-browser-external_commonjs-proxy-DjIx6Adb.js";import"./index.esm-Duzu12F9.js";import"./axios-B4uVmeYG.js";import"./useTranslation-BOupZ7-X.js";import"./Filter-BZ5YA63n.js";/* empty css               */class k extends w{constructor(){super(...arguments);x(this,"path","admin/messages")}}const m=new k,M=()=>{var d;const t=n.useRef(),i=n.useRef(),[s,h]=n.useState(null),f=async a=>{const{isConfirmed:l}=await C.fire({title:"Eliminar mensaje",text:"¿Estas seguro de eliminar este mensaje?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});!l||!await m.delete(a)||$(t.current).dxDataGrid("instance").refresh()},o=a=>{a.seen||(m.boolean({id:a,field:"seen",value:!0}),$(t.current).dxDataGrid("instance").refresh()),h(a),$(i.current).modal("show")};return e.jsxs(e.Fragment,{children:[e.jsx(v,{gridRef:t,title:"Mensajes",rest:m,toolBar:a=>{a.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(t.current).dxDataGrid("instance").refresh()}})},exportable:!0,exportableName:"Mensajes",columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Nombre",cellTemplate:(a,{data:l})=>{r(a,e.jsx("span",{style:{width:"100%",fontWeight:l.seen?"lighter":"bold",cursor:"pointer"},onClick:()=>o(l),children:l.name}))}},{dataField:"email",caption:"Correo"},{dataField:"phone",caption:"Teléfono"},{dataField:"modality",caption:"Modalidad",cellTemplate:(a,{data:l})=>{if(l.modality){const c=l.modality.toLowerCase()==="virtual";r(a,e.jsx("span",{className:`badge ${c?"bg-info":"bg-primary"} rounded-pill`,children:l.modality}))}else r(a,e.jsx("i",{className:"text-muted",children:"- Sin especificar -"}))}},{dataField:"age",caption:"Edad",width:80,alignment:"center"},{dataField:"service.title",caption:"Servicio",visible:!1,cellTemplate:(a,{data:l})=>{var c;r(a,e.jsx("span",{children:((c=l.service)==null?void 0:c.title)||e.jsx("i",{className:"text-muted",children:"- Consulta General -"})}))}},{dataField:"created_at",caption:"Fecha",dataType:"datetime",format:"yyyy-MM-dd HH:mm:ss",sortOrder:"desc"},{dataField:"status",caption:"Estado",dataType:"boolean",allowExporting:!1,cellTemplate:(a,{data:l})=>{l.seen?r(a,e.jsx("span",{className:"badge bg-success rounded-pill",children:"Leído"})):r(a,e.jsx("span",{className:"badge bg-danger rounded-pill",children:"No leído"}))}},{caption:"Acciones",cellTemplate:(a,{data:l})=>{a.append(p({className:"btn btn-xs btn-soft-dark",title:"Ver mensaje",icon:"fa fa-eye",onClick:()=>o(l)})),a.append(p({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>f(l.id)}))},allowFiltering:!1,allowExporting:!1}]}),e.jsx(y,{modalRef:i,title:"Detalle del Mensaje",hideFooter:!0,size:"md",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-12 mb-3",children:e.jsx("div",{className:"card bg-light border-0",children:e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"avatar-md bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-3",children:e.jsx("i",{className:"fas fa-user fa-lg"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"mb-0",children:s==null?void 0:s.name}),e.jsx("small",{className:"text-muted",children:(s==null?void 0:s.email)||e.jsx("i",{children:"Sin correo"})})]})]})})})}),e.jsx("div",{className:"col-md-6 mb-3",children:e.jsxs("div",{className:"border rounded p-3 h-100",children:[e.jsxs("small",{className:"text-muted d-block mb-1",children:[e.jsx("i",{className:"fas fa-phone me-1"})," Teléfono"]}),e.jsx("span",{className:"fw-semibold",children:(s==null?void 0:s.phone)||e.jsx("i",{className:"text-muted",children:"No especificado"})})]})}),e.jsx("div",{className:"col-md-6 mb-3",children:e.jsxs("div",{className:"border rounded p-3 h-100",children:[e.jsxs("small",{className:"text-muted d-block mb-1",children:[e.jsx("i",{className:"fas fa-birthday-cake me-1"})," ","Edad"]}),e.jsx("span",{className:"fw-semibold",children:s!=null&&s.age?`${s.age} años`:e.jsx("i",{className:"text-muted",children:"No especificado"})})]})}),e.jsx("div",{className:"col-md-6 mb-3",children:e.jsxs("div",{className:"border rounded p-3 h-100",children:[e.jsxs("small",{className:"text-muted d-block mb-1",children:[e.jsx("i",{className:"fas fa-laptop me-1"})," Modalidad"]}),s!=null&&s.modality?e.jsx("span",{className:`badge ${s.modality.toLowerCase()==="virtual"?"bg-info":"bg-primary"}`,children:s.modality}):e.jsx("i",{className:"text-muted",children:"No especificado"})]})}),e.jsx("div",{className:"col-md-6 mb-3",children:e.jsxs("div",{className:"border rounded p-3 h-100",children:[e.jsxs("small",{className:"text-muted d-block mb-1",children:[e.jsx("i",{className:"fas fa-briefcase me-1"})," ","Servicio"]}),e.jsx("span",{className:"fw-semibold",children:((d=s==null?void 0:s.service)==null?void 0:d.title)||e.jsx("i",{className:"text-muted",children:"Consulta General"})})]})}),(s==null?void 0:s.subject)&&e.jsx("div",{className:"col-12 mb-3",children:e.jsxs("div",{className:"border rounded p-3",children:[e.jsxs("small",{className:"text-muted d-block mb-1",children:[e.jsx("i",{className:"fas fa-tag me-1"})," Asunto"]}),e.jsx("span",{className:"fw-semibold",children:s==null?void 0:s.subject})]})}),(s==null?void 0:s.description)&&e.jsx("div",{className:"col-12 mb-3",children:e.jsxs("div",{className:"border rounded p-3",children:[e.jsxs("small",{className:"text-muted d-block mb-1",children:[e.jsx("i",{className:"fas fa-comment me-1"})," ","Mensaje"]}),e.jsx("p",{className:"mb-0 mt-2",children:s==null?void 0:s.description})]})}),e.jsxs("div",{className:"col-12",children:[e.jsx("hr",{}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-calendar me-1"}),s!=null&&s.created_at?new Date(s.created_at).toLocaleString("es-PE"):""]}),(s==null?void 0:s.phone)&&e.jsxs("a",{href:`https://wa.me/51${s.phone.replace(/\D/g,"")}`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-success btn-sm",children:[e.jsx("i",{className:"fab fa-whatsapp me-1"})," ","Contactar por WhatsApp"]})]})]})]})})]})};g((t,i)=>{u(t).render(e.jsx(N,{...i,title:"Mensajes",children:e.jsx(M,{...i})}))});
